<!DOCTYPE html>
<html>
<head>
  <title>SVG.js</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.6.6/svg.min.js"></script>
<!--
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/Draggable-latest-beta.js"></script>
-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/utils/Draggable.min.js"></script>
  <script src ="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/plugins/CSSPlugin.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenLite.min.js"></script>

  <script src="https://code.responsivevoice.org/responsivevoice.js?key=j9BBiktC"></script>

    <!--

  <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous">
  </script>
  
  <script src="svg.draggable.min.js"></script>
  <script src="s3-us-west-2.amazonaws.com/s.cdpn.io/16327/ThrowPropsPlugin.min.js"></script>

  
  
-->


</head>
<body>
  
    <div id="drawing"></div>

    x
<script>
    var xdim = 900;
    var ydim = 600;
    
    var draw = SVG('drawing').size(xdim, ydim)
    //var rect1 = draw.rect(50, 50).attr({ fill: '#f06' })
    //var rect2 = draw.rect(10, 10).attr({ fill: '#f06' })


    draw.viewbox(0,0,450,300)

    var ajax = new XMLHttpRequest()
        ajax.open('GET', 'skilltest.svg', true)
        ajax.send()
        ajax.onload = function(e) {
            var svgimage = draw.svg(ajax.responseText) // put loaded file on SVG document

           // var element = SVG.get('svg_7')
            //console.log(element)

            //element.fill('#f06')

            //var sourceelements = SVG.select('.source').fill('#ccc')
            //console.log(sourceelements)


/*
            sourceelements.draggable({
            minX: 10
            , minY: 10
            , maxX: xdim-100
            , maxY: ydim-100
            , snapDistance: 20 
            })
*/
           /*
            var targetelements = SVG.select('.target');
           targetelements.members[0].click(function(e){
                this.stroke('#f00')
            })
           */
            
  /*
           var el = SVG.get("target_4");
           console.log(el)
           el.stroke('#f00')
           el.attr('x',5)
           //el.draggable()
*/


        //   var targets = $(".target");

      

           var t1 = SVG.select('.target')


  //          console.log(t1)
    //      console.log(t1.members[1].rbox())

    readtext = SVG.select('.question').members[0].node.innerHTML;
    console.log(readtext)

    responsiveVoice.speak(readtext, "Norwegian Female")

//    responsiveVoice.speak("Skilpaddene er sultne. Gi dem 2 salatblader hver.", "Norwegian Female")





      //  var pos = t1.members[0].rbox();
      //  console.log(pos.x)

//t1.members[3].dx(-200)
//var t = Math.round(pos.x + " " + pos.y)
//t = "23 35"
//console.log(t)
        var imid = svgimage.node.id;
        console.log(imid)
            // WEIRD BEHAVIOR!!! I think only a problem on Chrome.. 
            //TweenLite.set("#"+imid, { touchAction: "pan-x"});
            TweenLite.set("#"+imid, { touchAction: "manipulation"});
           Draggable.create(".source", {
                
                bounds:"#"+imid,
                onDragEnd: function() {
                  var i = t1.members.length;
                  while (--i > -1) {
                    if (this.hitTest(t1.members[i].node)) 
                        {
                          var pos = t1.members[i].bbox();
                          var t = pos.x2*0.97  + " " +pos.cy*0.95;
                          //console.log(t)
                          TweenLite.to(this.target, 0.6, {opacity:0, scale:0, svgOrigin:t});

                        //    r = 1+0.25*(Math.random() -0.5);
                         //   r2 = Math.random();
                           // console.log(r)
                          //responsiveVoice.speak("nam. nam", "Norwegian Male", {pitch: r2, rate:r})

                          responsiveVoice.speak("nam. nam", "Norwegian Male", {pitch: 0.8, rate:1.5})
                  //t1.stroke('#f00')
                        }
                    else {
                        // t1.stroke('#000')
                    }
  }}




           });
/*
            var selectelements = SVG.select('.target');
            selectelements.click(function(e){
                console.log(this._stroke)
                if (this._stroke=='#f00') {
                    console.log('red')
                    this.stroke('#000')
  //                  this.attr('stroke-width',0);
                }else {
                this.stroke('#f00')
//                this.attr('stroke-width',.1);
                }
            })
*/

            //var b = elements.members[0].rbox();
            //draw.rect(b.width, b.height).addClass('box').move(b.x, b.y)


/*
            targetelements.click(function(e){
                e.fill('#f00')
            })

*/

            }

            

    //var elements = SVG.select('rect.my-class')
    
            

    //var rect3 = draw.rect(10, 10).attr({ fill: '#f06' })
    //var rect4 = draw.rect(10, 10).attr({ fill: '#f06' })
   //rect1.draggable({snapToGrid:100})
  // rect1.draggable({
  //minX: 10
//, minY: 15
//, maxX: 200
//, maxY: 100
//, snapToGrid: 20 
//})
  // rect1.draggable({snapToGrid:20})

/*
var gridSize = 20;
rect1.draggable(function(x, y){
    return {
       x: x - x % gridSize,
      y: y - y % gridSize
 };
});

*/

   //rect3.draggable()
   //rect4.draggable()
    
</script>

<style>
svgcontainer {
  display:block;
  position:relative;
  background:#1d1d1d;
  
  margin:20px auto;
}

html {
  touch-action: pan-y;
}
</style>


</body>



</html>